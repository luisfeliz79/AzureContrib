{
  "version": "Notebook/1.0",
  "items": [
    {
      "type": 1,
      "content": {
        "json": "# Application Insights Tagging Demo"
      },
      "name": "text - 3"
    },
    {
      "type": 9,
      "content": {
        "version": "KqlParameterItem/1.0",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "parameters": [
          {
            "id": "026e5021-c2e9-45f0-bb60-88dd36f98599",
            "version": "KqlParameterItem/1.0",
            "name": "Workspace",
            "label": "Log Analytics Workspace",
            "type": 5,
            "isRequired": true,
            "query": "resources\r\n| where type == \"microsoft.operationalinsights/workspaces\"\r\n| project id\r\n| sort by id asc",
            "crossComponentResources": [
              "value::tenant"
            ],
            "typeSettings": {
              "additionalResourceOptions": []
            },
            "queryType": 1,
            "resourceType": "microsoft.resources/tenants",
            "value": "{Workspace}"
          },
          {
            "id": "39f79030-116c-4957-8a8e-1bdb22d05082",
            "version": "KqlParameterItem/1.0",
            "name": "JobName",
            "label": "Job Name",
            "type": 2,
            "query": "AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where isnotempty(jobName)\r\n| distinct jobName",
            "crossComponentResources": [
              "{Workspace}"
            ],
            "typeSettings": {
              "additionalResourceOptions": [],
              "showDefault": false
            },
            "timeContext": {
              "durationMs": 1800000
            },
            "queryType": 0,
            "resourceType": "microsoft.operationalinsights/workspaces",
            "value": "test142mb1682456168865"
          }
        ],
        "style": "pills",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces"
      },
      "name": "parameters - 4"
    },
    {
      "type": 1,
      "content": {
        "json": "## Job Metrics"
      },
      "name": "text - 0"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "let linesread=AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == \"lines.read\"\r\n| extend Title=tostring(\"Lines Read\");\r\nlet writetime=AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == \"write.time\"\r\n| extend Title=tostring(\"Write Time in seconds\");\r\nlet writespeed=AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == \"write.speed\"\r\n| extend Title=tostring(\"Write Speed in MB/s\");\r\nlet readspeed=AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == \"read.speed\"\r\n| extend Title=tostring(\"Read Speed in MB/s\");\r\nlet readtime=AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == \"read.time\"\r\n| extend Title=tostring(\"Read Time in seconds\");\r\nunion linesread,writetime,writespeed,readtime,readspeed\r\n| summarize max(Max) by Title\r\n| sort by Title\r\n\r\n",
        "size": 4,
        "showAnalytics": true,
        "timeContext": {
          "durationMs": 1800000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "tiles",
        "tileSettings": {
          "titleContent": {
            "columnMatch": "Title"
          },
          "leftContent": {
            "columnMatch": "max_Max",
            "formatter": 12,
            "formatOptions": {
              "palette": "auto"
            }
          },
          "showBorder": false
        }
      },
      "name": "query - 8"
    },
    {
      "type": 1,
      "content": {
        "json": "## JVM Metrics"
      },
      "name": "text - 1"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| extend Max = Max * 100\r\n| where Name == 'system_cpu_usage'\r\n| project TimeGenerated,Max\r\n\r\n\r\n",
        "size": 1,
        "aggregation": 3,
        "showAnalytics": true,
        "title": "CPU Usage",
        "timeContext": {
          "durationMs": 1800000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "areachart",
        "tileSettings": {
          "showBorder": false
        },
        "graphSettings": {
          "type": 0
        },
        "chartSettings": {
          "yAxis": [
            "Max"
          ],
          "ySettings": {
            "numberFormatSettings": {
              "unit": 1,
              "options": {
                "style": "decimal",
                "useGrouping": true
              }
            }
          }
        }
      },
      "customWidth": "33",
      "name": "query - 5"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "AppMetrics\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n| where Name == 'jvm_memory_used'\r\n| project Max,TimeGenerated\r\n\r\n\r\n",
        "size": 1,
        "aggregation": 3,
        "showAnalytics": true,
        "title": "Memory Usage",
        "timeContext": {
          "durationMs": 1800000
        },
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "visualization": "areachart",
        "chartSettings": {
          "xAxis": "TimeGenerated"
        }
      },
      "customWidth": "33",
      "name": "query - 5 - Copy"
    },
    {
      "type": 1,
      "content": {
        "json": "## Logs"
      },
      "name": "text - 2 - Copy"
    },
    {
      "type": 3,
      "content": {
        "version": "KqlItem/1.0",
        "query": "union AppTraces,AppDependencies,AppExceptions,AppRequests\r\n| where AppRoleName == \"TaggingDemoClient\"\r\n| extend jobName = tostring(Properties.jobName)\r\n| where jobName == '{JobName}' or '{JobName}' == ''\r\n//| where isnotempty(Message)\r\n| where isnotempty(jobName)\r\n//| project TimeGenerated,jobName,Message",
        "size": 0,
        "showAnalytics": true,
        "timeContext": {
          "durationMs": 1800000
        },
        "showExportToExcel": true,
        "exportToExcelOptions": "all",
        "queryType": 0,
        "resourceType": "microsoft.operationalinsights/workspaces",
        "crossComponentResources": [
          "{Workspace}"
        ],
        "gridSettings": {
          "rowLimit": 1500,
          "filter": true
        }
      },
      "name": "query - 9"
    }
  ],
  "fallbackResourceIds": [
    "azure monitor"
  ],
  "$schema": "https://github.com/Microsoft/Application-Insights-Workbooks/blob/master/schema/workbook.json"
}